(function(w){"strict";var backend={reportError:function(error){}};var token="1234";var ajax={upload:function(files){console.log("sending file");this.sendFile(files.files[0])},ajax:function(url,callback,method,data){method=method||"get";data=data||null;var oReq=new XMLHttpRequest;oReq.addEventListener("progress",null,false);oReq.onload=callback;oReq.open(method,url,false);oReq.send(data)},sendFile:function(file){var uri="http://localhost:2444";var xhr=new XMLHttpRequest;var fd=new FormData;xhr.open("POST",uri,true);xhr.addEventListener("progress",this.updateProgress,false);xhr.onreadystatechange=function(){if(xhr.readyState==4&&xhr.status==200){console.log("hi");alert(xhr.responseText)}};fd.append("myFile",file);xhr.send(fd)},updateProgress:function(e){console.log(e)},authenticate:function(callback){ajax.ajax("://api.readmecookie.com/auth",callback,"POST","token="+token)}};w.Ajax=ajax})(window);(function(window){"use strict";var patterns={},structure;structure={getStructure:function(name,variables){var structureWanted=this.htmlNodes(patterns[name])[0];if(typeof structureWanted=="undefined"){console.warn('Structure "'+name+'" not found!');return false}else{var insert=structureWanted.getElementsByClassName("insert_here");if(insert.length===0){return structureWanted}else{var typeofVariables=typeof variables;if(typeofVariables==="undefined"){console.warn('Structure "'+name+'" demands variables but got none recieved');return false}else if(typeofVariables==="string"){}else if(typeofVariables==="object"){var nodes=this.htmlNodes(variables);for(var key in nodes){insert.appendChild(nodes[key])}}insert.classList.remove("insert_here")}return structureWanted}},addPattern:function(name,object){if(typeof object!=="object"){console.warn("Object is invalid or undefined: "+object)}if(typeof name!=="string"){console.warn("Name is invalid or undefined: "+name)}patterns[name]=object},patternExists:function(name){if(patterns.hasOwnProperty(name)){return true}return false},htmlNodes:function(obj){var ToReturn=[];for(var key in obj){if(obj.hasOwnProperty(key)){var value=obj[key];if(typeof value==="object"){if(typeof value.type!=="undefined"){var repeat=value.repeat||1;for(var i=0;i<repeat;i++){var node=document.createElement(value.type);if(typeof value.class==="string"){node.className=value.class}if(typeof value.id==="string"){node.id=value.id}if(value.editable===true){node.contentEditable="true"}if(typeof value.text==="string"){node.innerHTML=value.text}if(typeof value.src==="string"){node.src=value.src}if(typeof value.height==="string"||typeof value.height==="number"){node.height=value.height}if(typeof value.width==="string"||typeof value.height==="number"){node.width=value.width}if(typeof value.children==="array"||typeof value.children==="object"){var children=this.htmlNodes(value.children);for(var objects in children){node.appendChild(children[objects])}}if(repeat>0){ToReturn[ToReturn.length]=node}else{ToReturn[key]=node}}}else{console.warn("Invalid structure setup!")}}else{console.warn("Invalid structure setup!")}}else{console.warn("Invalid structure setup!")}}return ToReturn}};window.Structure=structure})(window);Structure.addPattern("post",[{type:"article",class:"post",children:[{type:"header",children:[{type:"div",class:"date"},{type:"h2",editable:true},{type:"div",class:"meta"}]},{type:"div",class:"content",children:[{type:"p",editable:true}]}]}]);Structure.addPattern("prompt",[{type:"p",text:"Are you sure you want to publish the changes to these posts",children:[{type:"ul",children:[{type:"li",class:"insert_here",children:[{type:"p",text:"Money keys"},{type:"span",class:"revert",text:"revert"}]}]}]}]);(function(window){"use strict";var increment=0,mainDiv=document.getElementsByClassName("main")[0],postsDiv=mainDiv.getElementsByClassName("posts")[0];var editor={addPost:function(){var postStructure=Structure.getStructure("post");editor.addEvents(postStructure);postStructure.id=increment;increment++;postsDiv.insertBefore(postStructure,postsDiv.getElementsByClassName("clear")[0]);Animate.css(postStructure,"slideDown",null)},addEvents:function(el){el.addEventListener("keydown",function(e){this.classList.add("changed");var defined=false;if(e.metaKey&&e.keyCode===66){console.log("Bold!");editor.doRichEditCommand("bold");defined=true}else if(e.keyCode==9){doRichEditCommand("indent");defined=true}if(defined){e.preventDefault();e.stopPropagation()}})},publishPosts:function(){console.log("publishing posddd d!");editor.getChangedPosts()},getChangedPosts:function(){console.log(mainDiv.getElementsByClassName("post changed"))},doRichEditCommand:function(aName,aArg){document.execCommand(aName,false,aArg)}};window.Editor=editor})(window);(function(window){"strict";var mainContainer=document.getElementsByClassName("main")[0];var pageManager={loadHtml:function(name,options,callback){options={controlboard:options.controlboard||false};if(Structure.patternExists(name)===true){console.log("Pattern already found: "+name);pageManager.appendHtml(name,options,callback)}else{ajax.ajax("json/"+name+".json",function(){if(this.status==200){console.log("Regisering pattern: "+name);Structure.addPattern(name,JSON.parse(this.response));pageManager.appendHtml(name,options,callback)}else{var status=this.status;switch(status){case 404:console.warn(name+" File not found");break;case 502:console.warn("Internal server error (Ajax)");break}}})}},appendHtml:function(name,options,callback){var htmlDom=Structure.getStructure(name);Animate.css(mainContainer,"fadeOut",function(){mainContainer.innerHTML=null;mainContainer.appendChild(htmlDom);if(options.controlboard===false){Animate.css(document.getElementsByClassName("control")[0],"fadeOut",function(el){el.style.display="none"})}callback()})},loadPage:function(name){if(name==="statistics"){pageManager.loadHtml(name,{},function(){var tLabels=[];for(var i=31;i>0;i--){tLabels.push({x:i,y:Math.round((Math.sin(i+1)*.3+Math.random()+1)*1e3)})}tLabels.reverse();console.log(document.getElementsByClassName("pageviews-chart")[0].getElementsByTagName("div")[0]);var graph=new Rickshaw.Graph({element:document.getElementsByClassName("pageviews-chart")[0].getElementsByTagName("div")[0],renderer:"bar",series:[{data:tLabels,color:"black"}]});var hoverDetail=new Rickshaw.Graph.HoverDetail({graph:graph,xFormatter:function(x){return x+" days ago"},yFormatter:function(y){return y+" views"}});graph.render()})}else if(name==="newfile"){pageManager.loadHtml(name,{},function(){console.log("hi");document.getElementsByClassName("add")[0].addEventListener("click",Editor.addPost)})}}};window.PageManager=pageManager})(window);(function(window){"use strict";var animate={css:function(el,animation,callback,finalClass){var original=el.className,time=0;if(typeof finalClass!="string")finalClass=original;if(typeof time!="string")time="200";if(animation==="slideDown"||animation==="slideUp"){time=1e3}else if(animation==="fadeOut"||animation==="fadeIn"){time=200}else{console.warn("Animation failed, type of animation not found: "+animation);return false}el.className=original+" "+animation;setTimeout(function(){el.className=finalClass;if(typeof callback==="function"){callback(el)}},time);return true}};window.Animate=animate})(window);(function(){"use strict";var addButt=document.getElementsByClassName("add")[0],publishButts=document.getElementsByClassName("publish")[0],menus=document.getElementsByTagName("nav");addButt.addEventListener("click",Editor.addPost);publishButts.addEventListener("click",Editor.publishPosts);console.log(sessionStorage.getItem("token"));for(var menukey in menus){var menu=menus[menukey];if(typeof menu==="object"){var anchors=menu.getElementsByTagName("a");for(var anchorkey in anchors){var anchor=anchors[anchorkey];if(typeof anchor==="object"){anchors[anchorkey].addEventListener("click",function(e){var structureName=this.hash.substring(1);PageManager.loadPage(structureName);e.preventDefault();return false})}}}}})();
//# sourceMappingURL=compressed.js.map